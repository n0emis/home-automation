---
ansible_python_interpreter: "/usr/bin/python3"

wireguard_server_address: "10.152.18.1/32"

postgresql_users:
  - name: "{{ synapse_database_user }}"
    password: "{{ synapse_database_password }}"
  - name: "{{ keycloak_postgresql_username }}"
    password: "{{ keycloak_postgresql_password }}"
  - name: "{{ gitea_db_user }}"
    password: "{{ gitea_db_password }}"
  - name: "{{ mautrix_signal_db_user }}"
    password: "{{ mautrix_signal_db_password }}"
  - name: "{{ matrix_media_repo_db_user }}"
    password: "{{ matrix_media_repo_db_password }}"
postgresql_databases:
  - name: "{{ synapse_database_database }}"
    owner: "{{ synapse_database_user }}"
    lc_collate: 'C'
    lc_ctype: 'C'
  - name: "{{ keycloak_postgresql_database }}"
    owner: "{{ keycloak_postgresql_username }}"
  - name: "{{ gitea_db_name }}"
    owner: "{{ gitea_db_user }}"
  - name: "{{ mautrix_signal_db_name }}"
    owner: "{{ mautrix_signal_db_user }}"
  - name: "{{ matrix_media_repo_db_user }}"
    owner: "{{ matrix_media_repo_db_name }}"

coturn_static_auth_secret: "{{ lookup('passwordstore', 'infra/' + ansible_fqdn + '/coturn') }}"
coturn_realm: "turn.n0emis.eu"

pdns_rec_forward_dyn: "127.0.0.1:5300"

nginx_user: www-data
nginx_remove_default_vhost: true
nginx_vhosts:
  - filename: "n0emis.eu.conf"
    server_name: "_"
    listen: "81"
    state: "present"
    extra_parameters: |
      absolute_redirect off;

      location /.well-known/matrix/server {
        default_type application/json;
        return 200 '{"m.server": "{{ synapse_server_fqdn_matrix }}:443"}';
      }

      location /.well-known/matrix/client {
        default_type application/json;
        return 200 '{"m.homeserver": {"base_url": "https://{{ synapse_server_fqdn_matrix }}"}}';
      }
